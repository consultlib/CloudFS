<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Application Tutorial &mdash; Lucid v1.0 documentation</title>
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
          URL_ROOT:    '../../',
          VERSION:     '1.0',
          COLLAPSE_MODINDEX: false,
          FILE_SUFFIX: ''
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/interface.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="contents" title="Global table of contents" href="../../contents.html" />
    <link rel="index" title="Global index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="top" title="Lucid v1.0 documentation" href="../../index.html" />
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li><a href="../../index.html">Lucid v1.0 documentation</a> &raquo;</li>
      </ul>
    </div>
    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  
  <div class="section" id="s-application-tutorial">
<span id="s-dev-intro-application-tutorial"></span><h1 id="application-tutorial"><span id="dev-intro-application-tutorial"></span>Application Tutorial<a class="headerlink" href="#application-tutorial" title="Permalink to this headline">¶</a></h1>
<p>Application development with Lucid is very easy, and you can make full featured applications very quickly using a combination of Dojo, and it&#8217;s built-in APIs.</p>
<p>This tutorial will assume that you know how to use Dojo&#8217;s widget system. If you don&#8217;t, it is suggested you take a look at <a class="reference" href="http://dojotoolkit.org/docs">Dojo&#8217;s documentation</a>. before we begin.</p>
<p>You can use Katana IDE to write your application, or you may use your favorite text editor. If you use a text editor, you have to create the app in the IDE first, and then open <tt class="docutils literal"><span class="pre">/desktop/dojotoolkit/desktop/apps/YourApp.js</span></tt> in the text editor.</p>
<p>In this tutorial, we will be writing a simple contact manager app. You will see how easy it is to make such a useful application. From the IDE, click on the &#8216;New&#8217; button, and enter in &#8216;MyContacts&#8217; as the System name, and &#8216;My Contacts&#8217; as the displayed name. System names cannot contain spaces, should start with a letter, and should be camel-cased. Displayed names, however, can contain anything. The IDE will then create your application, and give you the skeleton below.</p>
<div class="highlight"><pre><span class="nx">dojo</span><span class="p">.</span><span class="nx">provide</span><span class="p">(</span><span class="s2">&quot;lucid.apps.MyContacts&quot;</span><span class="p">);</span>

<span class="nx">dojo</span><span class="p">.</span><span class="nx">declare</span><span class="p">(</span><span class="s2">&quot;lucid.apps.MyContacts&quot;</span><span class="o">,</span> <span class="nx">desktop</span><span class="p">.</span><span class="nx">apps</span><span class="p">.</span><span class="nx">_App</span><span class="o">,</span> <span class="p">{</span>
    <span class="nx">init</span><span class="o">:</span> <span class="k">function</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="c">/*Startup code goes here*/</span>
    <span class="p">}</span>
    <span class="nx">kill</span><span class="o">:</span> <span class="k">function</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="c">/*Cleanup code goes here*/</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></div>
<p>If you're familiar with Dojo, you'll see that each app is essentially a class in the destkop.apps namespace. In other words, Lucid applications are really Dojo modules. Each app extends a base <tt class="docutils literal"><span class="pre">_App</span></tt> class, which provides some basic self-management functionality.</p>
<p>Let's examine this. We have two functions, <tt class="docutils literal"><span class="pre">init</span></tt> and <tt class="docutils literal"><span class="pre">kill</span></tt>. <tt class="docutils literal"><span class="pre">init</span></tt> is called when the application is launched, and <tt class="docutils literal"><span class="pre">kill</span></tt> is called when the application shuts down. Simple, right?</p>
<div class="section" id="s-creating-windows">
<h2 id="creating-windows">Creating Windows<a class="headerlink" href="#creating-windows" title="Permalink to this headline">¶</a></h2>
<p>Now let's create a window. The <tt class="docutils literal"><span class="pre">lucid.widget.Window</span></tt> widget provides us with all the windows in the desktop. We'll add the following code to our init function:</p>
<div class="highlight"><pre><span class="k">this</span><span class="p">.</span><span class="nx">windows</span> <span class="o">=</span> <span class="p">[];</span>
<span class="k">var</span> <span class="nx">win</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">lucid</span><span class="p">.</span><span class="nx">widget</span><span class="p">.</span><span class="nx">Window</span><span class="p">({</span>
    <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;My Contacts&quot;</span><span class="o">,</span>
    <span class="nx">onClose</span><span class="o">:</span> <span class="nx">dojo</span><span class="p">.</span><span class="nx">hitch</span><span class="p">(</span><span class="k">this</span><span class="o">,</span> <span class="s2">&quot;kill&quot;</span><span class="p">)</span>
<span class="p">});</span>
<span class="k">this</span><span class="p">.</span><span class="nx">windows</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">win</span><span class="p">);</span>
<span class="nx">win</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
</pre></div>
<p>Now when you launch the app, it will show an empty window. Notice the onClose event. This is very important, because the base <tt class="docutils literal"><span class="pre">_App</span></tt> class uses <tt class="docutils literal"><span class="pre">dojo.connect</span></tt> to know when the app is being closed. After a small delay, it removes itself from the process table.</p>
<p>In the event that your application is killed from the task manager, your app must remove all open windows. This is where that <tt class="docutils literal"><span class="pre">this.windows</span></tt> array we made before comes into play. In your <tt class="docutils literal"><span class="pre">kill</span></tt> function, add the following code:</p>
<div class="highlight"><pre><span class="nx">dojo</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">windows</span><span class="o">,</span> <span class="k">function</span><span class="p">(</span><span class="nx">win</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">win</span><span class="p">.</span><span class="nx">closed</span><span class="p">)</span>
        <span class="nx">win</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
<span class="p">});</span>
</pre></div>
<p>This will close any open windows in the <tt class="docutils literal"><span class="pre">this.windows</span></tt> array. As our app uses more windows, we can append those onto this array.</p>
</div>
<div class="section" id="s-using-the-registry">
<h2 id="using-the-registry">Using the Registry<a class="headerlink" href="#using-the-registry" title="Permalink to this headline">¶</a></h2>
<p>Before we make our UI, we should make a <tt class="docutils literal"><span class="pre">Registry</span></tt> store to save our contacts in. Add this to the end of the <tt class="docutils literal"><span class="pre">init</span></tt> function, but before you call <tt class="docutils literal"><span class="pre">win.show()</span></tt>:</p>
<div class="highlight"><pre><span class="k">var</span> <span class="nx">contactStore</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">contactStore</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">lucid</span><span class="p">.</span><span class="nx">Registry</span><span class="p">({</span>
    <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;contacts&quot;</span><span class="o">,</span>
    <span class="nx">appname</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">sysname</span><span class="o">,</span>
    <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">identifier</span><span class="o">:</span> <span class="s2">&quot;id&quot;</span><span class="o">,</span>
        <span class="nx">items</span><span class="o">:</span> <span class="p">[]</span>
    <span class="p">}</span>
<span class="p">});</span>
<span class="nx">dojo</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">contactStore</span><span class="o">,</span> <span class="s2">&quot;onNew&quot;</span><span class="o">,</span> <span class="k">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">contactStore</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span> <span class="p">});</span>
<span class="nx">dojo</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">contactStore</span><span class="o">,</span> <span class="s2">&quot;onDelete&quot;</span><span class="o">,</span> <span class="k">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">contactStore</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span> <span class="p">});</span>
<span class="nx">dojo</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">contactStore</span><span class="o">,</span> <span class="s2">&quot;onSet&quot;</span><span class="o">,</span> <span class="k">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">contactStore</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span> <span class="p">});</span>
</pre></div>
<p>If you're experienced with Dojo, you'll notice that <tt class="docutils literal"><span class="pre">lucid.Registry</span></tt> is a <tt class="docutils literal"><span class="pre">dojo.data</span></tt> store. This store is unique, because it can store all of it's information on the server. The name of the store is a unique name, specific to your app. Two stores should never have the same name, so make sure you're descriptive when choosing the name of the store. We provide the store with our system name (contained in <tt class="docutils literal"><span class="pre">this.sysname</span></tt>), so that one app won't override the contents of another app's store. You'll also notice that the store is saved every time it's data changes. You'll see the store in action later in the tutorial.</p>
</div>
<div class="section" id="s-writing-the-ui">
<h2 id="writing-the-ui">Writing the UI<a class="headerlink" href="#writing-the-ui" title="Permalink to this headline">¶</a></h2>
<div class="section" id="s-making-a-toolbar">
<h3 id="making-a-toolbar">Making a Toolbar<a class="headerlink" href="#making-a-toolbar" title="Permalink to this headline">¶</a></h3>
<p>Now that we have our store defined, we can begin to piece together our UI. We'll start by adding some <tt class="docutils literal"><span class="pre">dojo.require</span></tt> calls to the top of our app, right underneath our <tt class="docutils literal"><span class="pre">dojo.declare</span></tt> statement.</p>
<div class="highlight"><pre><span class="nx">dojo</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;dijit.Toolbar&quot;</span><span class="p">);</span>
<span class="nx">dojo</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;dojox.grid.DataGrid&quot;</span><span class="p">);</span>
<span class="nx">dojo</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;dojox.grid.cells.dijit&quot;</span><span class="p">);</span>
<span class="nx">dojo</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;dijit.form.TextBox&quot;</span><span class="p">);</span>
<span class="nx">dojo</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;dijit.form.Button&quot;</span><span class="p">);</span>
<span class="nx">lucid</span><span class="p">.</span><span class="nx">addDojoCss</span><span class="p">(</span><span class="s2">&quot;dojox/grid/resources/Grid.css&quot;</span><span class="p">);</span>
</pre></div>
<p>This will load the widgets from the server when our app is loaded. Also note that we included a CSS file. This is because the <tt class="docutils literal"><span class="pre">dojox</span></tt> widgets are not included in the base stylesheet that Lucid uses, so we have to load them when we load the app.</p>
<p>Now that we have loaded our widgets, we can start drawing our UI. <tt class="docutils literal"><span class="pre">lucid.widget.Window</span></tt> is a subclassed <tt class="docutils literal"><span class="pre">BorderContainer</span></tt>, so you add a <tt class="docutils literal"><span class="pre">region</span></tt> property to position the element. It can be either &quot;top&quot;, &quot;bottom&quot;, &quot;leading&quot;, &quot;trailing&quot;, &quot;left&quot;, &quot;right&quot;, or &quot;center&quot;. Add the following code to your <tt class="docutils literal"><span class="pre">init</span></tt> function, just before you call <tt class="docutils literal"><span class="pre">win.show()</span></tt>:</p>
<div class="highlight"><pre><span class="k">var</span> <span class="nx">toolbar</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">dijit</span><span class="p">.</span><span class="nx">Toolbar</span><span class="p">({</span><span class="nx">region</span><span class="o">:</span> <span class="s2">&quot;top&quot;</span><span class="p">});</span>

<span class="k">var</span> <span class="nx">newButton</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">dijit</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">Button</span><span class="p">({</span>
    <span class="k">label</span><span class="o">:</span> <span class="s2">&quot;New Contact&quot;</span><span class="o">,</span>
    <span class="nx">iconClass</span><span class="o">:</span> <span class="s2">&quot;icon-16-actions-contact-new&quot;</span><span class="o">,</span>
    <span class="nx">onClick</span><span class="o">:</span> <span class="nx">dojo</span><span class="p">.</span><span class="nx">hitch</span><span class="p">(</span><span class="k">this</span><span class="o">,</span> <span class="s2">&quot;newContact&quot;</span><span class="p">)</span>
<span class="p">});</span>
<span class="nx">toolbar</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">newButton</span><span class="p">);</span>

<span class="k">var</span> <span class="nx">removeButton</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">dijit</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">Button</span><span class="p">({</span>
    <span class="k">label</span><span class="o">:</span> <span class="s2">&quot;Remove Contact&quot;</span><span class="o">,</span>
    <span class="nx">iconClass</span><span class="o">:</span> <span class="s2">&quot;icon-16-actions-edit-delete&quot;</span><span class="o">,</span>
    <span class="nx">onClick</span><span class="o">:</span> <span class="nx">dojo</span><span class="p">.</span><span class="nx">hitch</span><span class="p">(</span><span class="k">this</span><span class="o">,</span> <span class="s2">&quot;removeContact&quot;</span><span class="p">)</span>
<span class="p">});</span>
<span class="nx">toolbar</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">removeButton</span><span class="p">);</span>

<span class="nx">win</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">toolbar</span><span class="p">);</span>
</pre></div>
<p>We also need to add the methods we referenced for the toolbar to the app. Add this before the <tt class="docutils literal"><span class="pre">kill</span></tt> method in your app declaration:</p>
<div class="highlight"><pre><span class="nx">newContact</span><span class="o">:</span> <span class="k">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>

<span class="p">}</span><span class="o">,</span>
<span class="nx">removeContact</span><span class="o">:</span> <span class="k">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>

<span class="p">}</span><span class="o">,</span>
</pre></div>
</div>
<div class="section" id="s-adding-a-grid">
<h3 id="adding-a-grid">Adding a Grid<a class="headerlink" href="#adding-a-grid" title="Permalink to this headline">¶</a></h3>
<p>So, now we have a toolbar added to our window. Let's make a <tt class="docutils literal"><span class="pre">dojox.grid.DataGrid</span></tt> to display the contacts. Since Dojo's grid has editing functionality, we don't need an 'Edit Contact' dialog. Add the following code after the <tt class="docutils literal"><span class="pre">win.show()</span></tt> call:</p>
<div class="highlight"><pre><span class="k">var</span> <span class="nx">grid</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">grid</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">dojox</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">DataGrid</span><span class="p">({</span>
    <span class="nx">store</span><span class="o">:</span> <span class="nx">contactStore</span><span class="o">,</span>
    <span class="nx">region</span><span class="o">:</span> <span class="s2">&quot;center&quot;</span><span class="o">,</span>
    <span class="nx">structure</span><span class="o">:</span> <span class="p">[{</span>
        <span class="nx">cells</span><span class="o">:</span> <span class="p">[[</span>
            <span class="p">{</span><span class="nx">field</span><span class="o">:</span> <span class="s2">&quot;name&quot;</span><span class="o">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Name&quot;</span><span class="o">,</span> <span class="nx">editable</span><span class="o">:</span> <span class="kc">true</span><span class="o">,</span> <span class="nx">type</span><span class="o">:</span> <span class="nx">dojox</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">cells</span><span class="p">.</span><span class="nx">Cell</span><span class="o">,</span> <span class="nx">width</span><span class="o">:</span> <span class="s2">&quot;150px&quot;</span><span class="p">}</span><span class="o">,</span>
            <span class="p">{</span><span class="nx">field</span><span class="o">:</span> <span class="s2">&quot;email&quot;</span><span class="o">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Email&quot;</span><span class="o">,</span> <span class="nx">editable</span><span class="o">:</span> <span class="kc">true</span><span class="o">,</span> <span class="nx">type</span><span class="o">:</span> <span class="nx">dojox</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">cells</span><span class="p">.</span><span class="nx">Cell</span><span class="o">,</span> <span class="nx">width</span><span class="o">:</span> <span class="s2">&quot;150px&quot;</span><span class="p">}</span><span class="o">,</span>
            <span class="p">{</span><span class="nx">field</span><span class="o">:</span> <span class="s2">&quot;phone&quot;</span><span class="o">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Phone Number&quot;</span><span class="o">,</span> <span class="nx">editable</span><span class="o">:</span> <span class="kc">true</span><span class="o">,</span> <span class="nx">type</span><span class="o">:</span> <span class="nx">dojox</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">cells</span><span class="p">.</span><span class="nx">Cell</span><span class="o">,</span> <span class="nx">width</span><span class="o">:</span> <span class="s2">&quot;100px&quot;</span><span class="p">}</span><span class="o">,</span>
            <span class="p">{</span><span class="nx">field</span><span class="o">:</span> <span class="s2">&quot;address&quot;</span><span class="o">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Address&quot;</span><span class="o">,</span> <span class="nx">editable</span><span class="o">:</span> <span class="kc">true</span><span class="o">,</span> <span class="nx">type</span><span class="o">:</span> <span class="nx">dojox</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">cells</span><span class="p">.</span><span class="nx">Editor</span><span class="o">,</span> <span class="nx">editorToolbar</span><span class="o">:</span> <span class="kc">false</span><span class="o">,</span> <span class="nx">width</span><span class="o">:</span> <span class="s2">&quot;auto&quot;</span><span class="p">}</span>
        <span class="p">]]</span>
    <span class="p">}]</span>
<span class="p">});</span>
<span class="nx">win</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">grid</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="s-working-with-the-registry">
<h2 id="working-with-the-registry">Working with the Registry<a class="headerlink" href="#working-with-the-registry" title="Permalink to this headline">¶</a></h2>
<p>Now that we have our grid, we can now define the methods that add and remove contacts to our store. Remember, <tt class="docutils literal"><span class="pre">lucid.Registry</span></tt> is a <tt class="docutils literal"><span class="pre">dojo.data</span></tt> store. When we made the store, we set it up so that it will save it's contents whenever a field is changed, so we don't have to worry about saving the store when we close the application.</p>
<p>Add the following code to your new/removeContact methods:</p>
<div class="highlight"><pre><span class="nx">newContact</span><span class="o">:</span> <span class="k">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
    <span class="k">var</span> <span class="nx">store</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">contactStore</span><span class="o">;</span>
    <span class="nx">store</span><span class="p">.</span><span class="nx">newItem</span><span class="p">({</span>
        <span class="nx">id</span><span class="o">:</span> <span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">()).</span><span class="nx">toString</span><span class="p">()</span><span class="o">,</span> <span class="c">//to prevent id collisions</span>
        <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;New Contact&quot;</span><span class="o">,</span>
        <span class="nx">email</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="o">,</span>
        <span class="nx">phone</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="o">,</span>
        <span class="nx">address</span><span class="o">:</span> <span class="s2">&quot;&quot;</span>
    <span class="p">});</span>
<span class="p">}</span><span class="o">,</span>
<span class="nx">removeContact</span><span class="o">:</span> <span class="k">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">removeSelectedRows</span><span class="p">();</span>
<span class="p">}</span><span class="o">,</span>
</pre></div>
</div>
<div class="section" id="s-final-product">
<h2 id="final-product">Final Product<a class="headerlink" href="#final-product" title="Permalink to this headline">¶</a></h2>
<p>You should now be able to add and remove contacts from the grid:</p>
<img alt="Finished contacts application window" src="../../_images/screenshot.png" />
<p>To edit a field, double-click on the cell and input some text. To save it, click on a different cell.</p>
<p>Here's the full application's code:</p>
<div class="highlight"><pre><span class="nx">dojo</span><span class="p">.</span><span class="nx">provide</span><span class="p">(</span><span class="s2">&quot;lucid.apps.MyContacts&quot;</span><span class="p">);</span>
<span class="nx">dojo</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;dijit.Toolbar&quot;</span><span class="p">);</span>
<span class="nx">dojo</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;dojox.grid.DataGrid&quot;</span><span class="p">);</span>
<span class="nx">dojo</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;dojox.grid.cells.dijit&quot;</span><span class="p">);</span>
<span class="nx">dojo</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;dijit.form.TextBox&quot;</span><span class="p">);</span>
<span class="nx">dojo</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;dijit.form.Button&quot;</span><span class="p">);</span>
<span class="nx">lucid</span><span class="p">.</span><span class="nx">addDojoCss</span><span class="p">(</span><span class="s2">&quot;dojox/grid/resources/Grid.css&quot;</span><span class="p">);</span>

<span class="nx">dojo</span><span class="p">.</span><span class="nx">declare</span><span class="p">(</span><span class="s2">&quot;lucid.apps.MyContacts&quot;</span><span class="o">,</span> <span class="nx">desktop</span><span class="p">.</span><span class="nx">apps</span><span class="p">.</span><span class="nx">_App</span><span class="o">,</span> <span class="p">{</span>
    <span class="nx">init</span><span class="o">:</span> <span class="k">function</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">windows</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">var</span> <span class="nx">win</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">lucid</span><span class="p">.</span><span class="nx">widget</span><span class="p">.</span><span class="nx">Window</span><span class="p">({</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;My Contacts&quot;</span><span class="o">,</span>
            <span class="nx">onClose</span><span class="o">:</span> <span class="nx">dojo</span><span class="p">.</span><span class="nx">hitch</span><span class="p">(</span><span class="k">this</span><span class="o">,</span> <span class="s2">&quot;kill&quot;</span><span class="p">)</span>
        <span class="p">});</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">windows</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">win</span><span class="p">);</span>

        <span class="k">var</span> <span class="nx">contactStore</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">contactStore</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">lucid</span><span class="p">.</span><span class="nx">Registry</span><span class="p">({</span>
            <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;contacts&quot;</span><span class="o">,</span>
            <span class="nx">appname</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">sysname</span><span class="o">,</span>
            <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">identifier</span><span class="o">:</span> <span class="s2">&quot;id&quot;</span><span class="o">,</span>
                <span class="nx">items</span><span class="o">:</span> <span class="p">[]</span>
            <span class="p">}</span>
        <span class="p">});</span>
        <span class="nx">dojo</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">contactStore</span><span class="o">,</span> <span class="s2">&quot;onSet&quot;</span><span class="o">,</span> <span class="k">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">contactStore</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span> <span class="p">});</span>

        <span class="k">var</span> <span class="nx">toolbar</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">dijit</span><span class="p">.</span><span class="nx">Toolbar</span><span class="p">({</span><span class="nx">region</span><span class="o">:</span> <span class="s2">&quot;top&quot;</span><span class="p">});</span>

        <span class="k">var</span> <span class="nx">newButton</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">dijit</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">Button</span><span class="p">({</span>
            <span class="k">label</span><span class="o">:</span> <span class="s2">&quot;New Contact&quot;</span><span class="o">,</span>
            <span class="nx">iconClass</span><span class="o">:</span> <span class="s2">&quot;icon-16-actions-contact-new&quot;</span><span class="o">,</span>
            <span class="nx">onClick</span><span class="o">:</span> <span class="nx">dojo</span><span class="p">.</span><span class="nx">hitch</span><span class="p">(</span><span class="k">this</span><span class="o">,</span> <span class="s2">&quot;newContact&quot;</span><span class="p">)</span>
        <span class="p">});</span>
        <span class="nx">toolbar</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">newButton</span><span class="p">);</span>

        <span class="k">var</span> <span class="nx">removeButton</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">dijit</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">Button</span><span class="p">({</span>
            <span class="k">label</span><span class="o">:</span> <span class="s2">&quot;Remove Contact&quot;</span><span class="o">,</span>
            <span class="nx">iconClass</span><span class="o">:</span> <span class="s2">&quot;icon-16-actions-edit-delete&quot;</span><span class="o">,</span>
            <span class="nx">onClick</span><span class="o">:</span> <span class="nx">dojo</span><span class="p">.</span><span class="nx">hitch</span><span class="p">(</span><span class="k">this</span><span class="o">,</span> <span class="s2">&quot;removeContact&quot;</span><span class="p">)</span>
        <span class="p">});</span>
        <span class="nx">toolbar</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">removeButton</span><span class="p">);</span>

        <span class="nx">win</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">toolbar</span><span class="p">);</span>

        <span class="nx">win</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>

        <span class="k">var</span> <span class="nx">grid</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">grid</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">dojox</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">DataGrid</span><span class="p">({</span>
            <span class="nx">store</span><span class="o">:</span> <span class="nx">contactStore</span><span class="o">,</span>
            <span class="nx">region</span><span class="o">:</span> <span class="s2">&quot;center&quot;</span><span class="o">,</span>
            <span class="nx">structure</span><span class="o">:</span> <span class="p">[{</span>
                <span class="nx">cells</span><span class="o">:</span> <span class="p">[[</span>
                    <span class="p">{</span><span class="nx">field</span><span class="o">:</span> <span class="s2">&quot;name&quot;</span><span class="o">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Name&quot;</span><span class="o">,</span> <span class="nx">editable</span><span class="o">:</span> <span class="kc">true</span><span class="o">,</span> <span class="nx">type</span><span class="o">:</span> <span class="nx">dojox</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">cells</span><span class="p">.</span><span class="nx">Cell</span><span class="o">,</span> <span class="nx">width</span><span class="o">:</span> <span class="s2">&quot;150px&quot;</span><span class="p">}</span><span class="o">,</span>
                    <span class="p">{</span><span class="nx">field</span><span class="o">:</span> <span class="s2">&quot;email&quot;</span><span class="o">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Email&quot;</span><span class="o">,</span> <span class="nx">editable</span><span class="o">:</span> <span class="kc">true</span><span class="o">,</span> <span class="nx">type</span><span class="o">:</span> <span class="nx">dojox</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">cells</span><span class="p">.</span><span class="nx">Cell</span><span class="o">,</span> <span class="nx">width</span><span class="o">:</span> <span class="s2">&quot;150px&quot;</span><span class="p">}</span><span class="o">,</span>
                    <span class="p">{</span><span class="nx">field</span><span class="o">:</span> <span class="s2">&quot;phone&quot;</span><span class="o">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Phone Number&quot;</span><span class="o">,</span> <span class="nx">editable</span><span class="o">:</span> <span class="kc">true</span><span class="o">,</span> <span class="nx">type</span><span class="o">:</span> <span class="nx">dojox</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">cells</span><span class="p">.</span><span class="nx">Cell</span><span class="o">,</span> <span class="nx">width</span><span class="o">:</span> <span class="s2">&quot;100px&quot;</span><span class="p">}</span><span class="o">,</span>
                    <span class="p">{</span><span class="nx">field</span><span class="o">:</span> <span class="s2">&quot;address&quot;</span><span class="o">,</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Address&quot;</span><span class="o">,</span> <span class="nx">editable</span><span class="o">:</span> <span class="kc">true</span><span class="o">,</span> <span class="nx">type</span><span class="o">:</span> <span class="nx">dojox</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">cells</span><span class="p">.</span><span class="nx">Editor</span><span class="o">,</span> <span class="nx">editorToolbar</span><span class="o">:</span> <span class="kc">false</span><span class="o">,</span> <span class="nx">width</span><span class="o">:</span> <span class="s2">&quot;auto&quot;</span><span class="p">}</span>
                <span class="p">]]</span>
            <span class="p">}]</span>
        <span class="p">});</span>
        <span class="nx">win</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">grid</span><span class="p">);</span>

        <span class="p">}</span><span class="o">,</span>
        <span class="nx">newContact</span><span class="o">:</span> <span class="k">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
        <span class="k">var</span> <span class="nx">store</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">contactStore</span><span class="o">;</span>
        <span class="nx">store</span><span class="p">.</span><span class="nx">newItem</span><span class="p">({</span>
            <span class="nx">id</span><span class="o">:</span> <span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">()).</span><span class="nx">toString</span><span class="p">()</span><span class="o">,</span> <span class="c">//to prevent id collisions</span>
            <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;New Contact&quot;</span><span class="o">,</span>
            <span class="nx">email</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="o">,</span>
            <span class="nx">phone</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="o">,</span>
            <span class="nx">address</span><span class="o">:</span> <span class="s2">&quot;&quot;</span>
        <span class="p">});</span>
    <span class="p">}</span><span class="o">,</span>
    <span class="nx">removeContact</span><span class="o">:</span> <span class="k">function</span><span class="p">(</span><span class="nx">e</span><span class="p">){</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">grid</span><span class="p">.</span><span class="nx">removeSelectedRows</span><span class="p">();</span>
    <span class="p">}</span><span class="o">,</span>
    <span class="nx">kill</span><span class="o">:</span> <span class="k">function</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">dojo</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">windows</span><span class="o">,</span> <span class="k">function</span><span class="p">(</span><span class="nx">win</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">win</span><span class="p">.</span><span class="nx">closed</span><span class="p">)</span>
                <span class="nx">win</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
<div class="section" id="s-summary">
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>As you can see, we can make useful applications with minimal effort in Lucid. In just 80 lines of code, we wrote a decent contact manager. With Lucid's rich set of APIs, and Dojo's excelent widget system, application development is almost too easy!</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3>Table Of Contents</h3>
            <ul>
<li><a class="reference" href="">Application Tutorial</a><ul>
<li><a class="reference" href="#creating-windows">Creating Windows</a></li>
<li><a class="reference" href="#using-the-registry">Using the Registry</a></li>
<li><a class="reference" href="#writing-the-ui">Writing the UI</a><ul>
<li><a class="reference" href="#making-a-toolbar">Making a Toolbar</a></li>
<li><a class="reference" href="#adding-a-grid">Adding a Grid</a></li>
</ul>
</li>
<li><a class="reference" href="#working-with-the-registry">Working with the Registry</a></li>
<li><a class="reference" href="#final-product">Final Product</a></li>
<li><a class="reference" href="#summary">Summary</a></li>
</ul>
</li>
</ul>

            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/dev/intro/application-tutorial.txt">Show Source</a></li>
            </ul>
            <h3>Quick search</h3>
            <form class="search" action="../../search.html" method="get">
              <input type="text" name="q" size="18" /> <input type="submit" value="Go" />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </form>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li><a href="../../index.html">Lucid v1.0 documentation</a> &raquo;</li>
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright Dojo Foundation and Lucid Contributors.
      Last updated on May 31, 2009.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
    </div>
  </body>
</html>